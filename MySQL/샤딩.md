# 샤딩
![[Pasted image 20250319014708.png]]
**데이터를 여러 샤드로 나누는 기법**
샤드: 샤딩을통해 분산된 데이터베이스
###### 샤딩 vs 수직 파티셔닝
샤딩은 데이터를 여러개의 DB에
수직 파티셔닝은 데이터를 하나의 DB에 여러개의 테이블로 쪼개는 차이가 있다
#### 단점
* 데이터가 물리적으로 분산되어 각 데이터베이스에 저장되어, 여러 샤드에 분산된 데이터를 JOIN 하는게 어렵다
* Hotspot이 발생하여 데이터가 집중되면 성능이 느려짐
	Hotspot 데이터를 여러 샤드로 골고루 분포시켜 성능을 향상 시켜야함
## 종류
### Hash Sharding
해시 함수를 사용하여 데이터를 특정 샤드에 저장한다
![[Pasted image 20250319014619.png]]
##### Modular Sharding
Hash Sharding의 종류로 **나머지 연산**을 사용해 샤드를 결정해 데이터를 분산 저장
* 샤드의 수가 정해져 있을때 유용
* **샤드의 수가 변경**되면 해시 함수 변경과 함께 **데이터 재정렬**이 필요함
### Range Sharding
![[Pasted image 20250319020156.png]]
**PK값의 범위로 데이터를 분류해 샤드에 저장한다.**
e.g) PK값이 1~1000은 1번 샤드, 2~2000은 2번 샤드에 저장
* 데이터 베이스 증설 작업에 큰 리소스가 필요하지 않다
	데이터 베이스 증설 작업에 Hash Sharding대비 리소스 소요가 작음
	* Hash Sharding은 db 증설시 데이터를 다시 재정렬해야해 리소스 소요가 큼
	급격히 증가할 수 있는 성격의 데이터에 적합
	* 급격히 증가함에 따라 데이터베이스 증설 작업이 높은 확률로 필요할 수 있기 때문
#### 단점
* Hotspot 문제가 발생하여 특정 샤드에 부담을 줄 수 있다
	* 다시 샤딩 작업을 거쳐 문제를 해결하고, 트레픽이 저조한 데이터는 특정 샤딩에 통합시켜 성능을 개선시킬 수 있다.
e.g) 인스타그램의 대부분 트래픽은 최신 게시물에 발생 따라서 최신 게시물이 몰려 최신 게시물이 저장된 특정 샤드에 부담을 주는 Hotspot 문제 발생. 
###### 참고
https://hudi.blog/db-partitioning-and-sharding/
