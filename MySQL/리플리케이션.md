# 리플리케이션
![[Pasted image 20250318215255.png]]
리플리케이션은 클러스터링과 달리 **DB를 여러개로 두는 분산 기법**이다.
구성은 **Master 서버와 Slave 서버로 구성**된다.
**Master 서버는 데이터 조작 쿼리**인 INSERT, UPDATE, DELETE를 처리하고, **Slave 서버는 데이터 조회 쿼리**인 SELECT를 처리한다.
**Slave 서버는 Master 서버의 데이터를 복제**한다.

실제 e.g) 서점 주인과 서점 직원이 있다 주인은 책을 관리하고 변경 사항을 어드민 페이지에 반영한다 직원들은 어드민 페이지를 통해 손님들에게 책의 위치를 알려준다. 주인이 어드민 페이지에 반영을 늦게한다면 직원은 잘못된 정보를 제공할 수 있다.
### Master 서버 데이터 동기화 처리 과정
![[Pasted image 20250318220617.png]]
1. Master 서버에 쓰기 트랜잭션이 수행
2. Master 서버는 데이터를 저장하고 트랜잭션 로그를 파일에 기록(BIN LOG)
3. Slave 서버는 IO Thread를 통해 Master 서버의 로그 파일(BIN LOG)을 파일(Replay Log)에 복사
4. Slave 서버는 SQL Thread를 통해 파일(Replay Log)를 한 줄씩 읽으며 데이터를 저장

Master와 Slave간의 데이터 무결성 검사를 하지 않는 비동기 방식으로 데이터를 동기화 
#### 장점
* 분산 서버를 둠으로써 DB의 부담을 줄이고 성능을 향상 시킬 수 있다.
* 비동기 방식으로 운영되어 지연 시간이 거의 없다
#### 단점
* 서로 다른 서버로 운영되다보니 데이터베이스의 버전 관리가 필요
	* 동일하게 맞추는게 Best, 버전이 다르면 Slave 서버가 상위 버전으로 하는게 최선
* 비동기 방식으로 Master 서버 데이터를 Slave 서버로 동기화 하는 과정에 일관성 있는 데이터를 제공 받지 못할 수 있음
	* 동기적으로 데이터를 동기화 하여 일관성은 보장하지만, 속도가 느려지는 문제 발생
* Master 서버가 다운되면 복구 및 대처가 까다로움
###### 참고
https://hahahoho5915.tistory.com/66
https://mangkyu.tistory.com/97
