객체에서의 연관관계에는 다양한 종류가 있다
1. 다대일 : 단방향, 양방향
2. 일대다 : 단방향
3. 일대일(주 테이블에 외래키) : 단반향, 양방향
4. 일대일(대상 테이블에 외래키) : 양방향
5. 다대다
## 다대일
###### 단방향
###### 양방향
## 일대다
### 단방향
일대다 단방향 관계는
일에 해당하는 엔티티가 다에 해당하는 테이블의 외래키를 관리하는 복잡한 형태.
```java
@Entity
public class Team {  
	@Id @GeneratedValue
	@Column(name = "TEAM_ID")
	private Long id;
	
	private String name;
	
	@OneToMany
	@JoinColumn(name = "TEAM_ID")
	private List<Member> members = new ArrayList<Member>();
}
```
일대다 단방향 관계 매핑시 @JoinColumn을 명시해야한다.
명시하지 않는다면 JPA가 연결 테이블을 중간에 두고 연관관계를 관리하는 조인 테이블 전략을 기본으로 사용해 매핑하기 때문
###### 단점
엔티티가 관리하는 외래키가 엔티티가 매핑하는 테이블이 아니라 다른 테이블에 관리되어, 외래키 관리가 복잡하다.
#### 일대다 단방향 매핑보다는 다대일 양방향 매핑
일대다 단방향 매핑은 다른테이블의 외래키를 관리해야해서 성능 문제(더 많은 SQL를 호출)가 생기고 관리가 부담스럽기때문에 일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하는게 좋다.
### 양방향(존재 X)
일대다 **양방향 관계는 존재하지 않는다**, 대신 다대일 양방향 관계를 사용해야한다.

데이터베이스 특성상 **항상 다쪽이 외래키를 관리**하기 때문에 일쪽을 연관관계 주인으로 지정하지 못하고 JPA에도 **@ManyToOne에 mappedBy속성**이 없다.

대안으로는 일대다 단방향 매핑을 설정하고, 반대편에 다대일 단방향 매핑을 읽기 전용으로 설정해 양방향인것처럼 보이게 하는방법은 있지만 일대다 단방향의 단점을 그대로 지니고 있어 추천하지는 않는다.
## 일대일
### 종류
일대일 관계는 주 테이블과 대상 테이블중 어느곳이 외래키를 관리하는지에 따라 분류된다.
#### 주 테이블에 외래 키
주 객체가 대상 객체를 참조하는 방식과 같이 주 테이블에 외래 키를 둬 대상 테이블을 참조한다.
외래 키를 객체 참조와 비슷하게 사용하기 때문에 객체지향 개발자들이 선호.
장점은 주 테이블만 확인했을때 대상 테이블과 연관관계가 있는지 알 수 있다.
###### 단방향
###### 양방향
#### 대상 테이블에 외래 키
전통적인 데이터베이스 개발자들이 선호하는 방식, 장점으로는 테이블의 관계가 일대일에서 일대다로 변경될때 테이블의 구조를 그대로 유지 가능
##### 단방향
JPA에서 지원하지 않는다, 대안으로는 **대상 엔티티에서 주엔티티로 단방향 연관관계로 수정**하거나, 양방향 관계로 설정하고 **대상 엔티티를 연관관계 주인**으로 설정하는 방법이다.
##### 양방향
주 엔티티를 mappedBy로 설정해 대상 엔티티를 연관관계 주인으로 설정하여 양방향 관계를 설정할 수 잇다. 
## 다대다
![[Pasted image 20250220201518.png]]
관계형 데이터베이스는 정규화된 테이블 2개로 다대다 관계를 표현하지 못한다. 
그래서 다대다 관계를 일대다, 다대일 관계로 풀어내는 연결 테이블을 사용한다.
##### 객체에서 다대다
객체는 객체 2개로 다대다 관계를 만드는게 가능하다. 각 객체의 참조에 컬렉션을 사용하면 된다.
### 단방향
@ManyToMany, @JoinTable을 사용해 연결 테이블과 바로 매핑하여 다대다 단방향 매핑이 가능하다 
또 연결 테이블에 바로 매핑해 연결테이블 엔티티 없이 매핑이 가능하다.
### 양방향
역방향에도 @ManyToMany를 사용하여 양방향 설정이 가능하고, 원하는 방향에 연관관계 주인을 지정해야한다. (양쪽 모두 외래키를 관리하면 외래키 충돌이 발생할 수 있어)
### 연결 엔티티 사용
연결 테이블이 확장되면 확장된 필드들을 주 엔티티, 대상 엔티티에서 조회가 불가능해 연결 엔티티를 통해 조회 해야한다. 
또한 엔티티의 관계도 테이블의 관계처럼 연결 엔티티를 일대다, 다대일 관계로 풀어야 한다.
#### 복합 기본 키
기본키 없이 연결관계를 맺는 엔티티의 아이디를 섞어 복합 기본 키를 설정할 수 있다.

연결 테이블를 사용할때 복합 기본키 키를 이용한다면 엔티티의 복합 기본 키 매핑를 위한 식별자 클래스를 따로 구현해야해 새로운 기본 키를 사용하는것을 추천한다.
#### 식별 관계
###### 식별 관계 : 받아온 식별자를 기본키 + 외래키로 사용
###### 비식별 관계 : 받아온 식별자를 외래키로 사용